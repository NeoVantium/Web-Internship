var fragrance;var SSFragranceFinder=function(){};var on_final_page=false;(function(){"use strict";function IsJsonString(str){try{jQuery.parseJSON(str);}catch(e){return false;}
return true;}
SSFragranceFinder.prototype.removeLoad=function(){$(".fragrance_wrap").removeClass('loading').addClass("open");$(".loading_bg").remove();};SSFragranceFinder.prototype.addLoad=function(){$(".fragrance_wrap").removeClass('open').addClass("loading").html('<div class="loading_bg"><div class="loading"><img src="interface/assets/images/white_back.gif" width="64" height="64" alt=""/></div></div>');};SSFragranceFinder.prototype.alert=function(type,text,sticky){$(".alert-bar").remove();var stickyContent='';if(sticky==="yes"){stickyContent='<button type="button" class="close" data-dismiss="alert">Ã—</button>';}
switch(type){case "red":$("body").prepend('<div class="alert-bar peek"><div class="alert alert-danger alert-info" role="alert">'+stickyContent+text+'</div></div>');setTimeout(function(){$(".alert-bar").removeClass("peek");if(sticky!=="yes"){fragrance.closeAlert(10000);}},300);break;case "blue":$("body").prepend('<div class="alert-bar peek"><div class="alert alert-info" role="alert">'+stickyContent+text+'</div></div>');setTimeout(function(){$(".alert-bar").removeClass("peek");if(sticky!=="yes"){fragrance.closeAlert(6000);}},300);break;case "green":$("body").prepend('<div class="alert-bar peek"><div class="alert alert-success" role="alert">'+stickyContent+text+'</div></div>');setTimeout(function(){$(".alert-bar").removeClass("peek");if(sticky!=="yes"){fragrance.closeAlert(6000);}},300);break;case "yellow":$("body").prepend('<div class="alert-bar peek"><div class="alert alert-warning" role="alert">'+stickyContent+text+'</div></div>');setTimeout(function(){$(".alert-bar").removeClass("peek");if(sticky!=="yes"){fragrance.closeAlert(6000);}},300);break;}
return true;};SSFragranceFinder.prototype.closeAlert=function(time){setTimeout(function(){$(".alert-bar").addClass("peek");},time);};SSFragranceFinder.prototype.register_actions=function(){$(".inlineForm").on("submit",function(){$.ajax({cache:false,async:true,type:'POST',url:'app/ajax/wte.php',data:$(this).serialize(),success:function(data){console.log(data);fragrance.alert("green","<strong>Great job! That fragrance has been added to your basket. You can add more or checkout now</strong>");}});return false;});$(".budget_filter").unbind("change").change(function(){$("#ssff_budget_filter").val($(".budget_filter").val());fragrance.load_matches();});$(".reshuffle").unbind("click").click(function(){fragrance.load_matches();});$('[data-toggle="tooltip"]').tooltip();$(".scff_option").unbind("click").click(function(){var action_function=$(this).data('action');var value=$(this).data('value');var data='&action=sc_ff_set&action_function='+action_function+'&value='+value;console.log(data);$.ajax({type:"POST",cache:false,url:'app/ajax/action',data:data}).done(function(data){console.log(data);fragrance.refresh();});});};SSFragranceFinder.prototype.refresh=function(){fragrance.addLoad();fragrance.load();};SSFragranceFinder.prototype.load=function(){var ssff_character_match=$("#ssff_character_match").val();var data='&action=sc_ff_load&on_final_page='+on_final_page+"&ssff_character_match="+ssff_character_match;$.ajax({type:"POST",cache:false,url:'app/ajax/action',data:data}).done(function(data){if(IsJsonString(data)){var obj=jQuery.parseJSON(data);if(obj.redirect!==undefined){window.location=obj.redirect;}
setTimeout(function(){$('#fragrance_view').ScrollTo();$(".fragrance_wrap").html(obj.content);fragrance.removeLoad();fragrance.register_actions();},0);}else{console.log(data);}});};SSFragranceFinder.prototype.load_matches=function(){var ssff_budget_filter=$("#ssff_budget_filter").val();var ssff_character_match=$("#ssff_character_match").val();var data='&action=sc_ff_load_matches&on_final_page='+on_final_page+"&ssff_character_match="+ssff_character_match+"&ssff_budget_filter="+ssff_budget_filter;$.ajax({type:"POST",cache:false,url:'app/ajax/action',data:data}).done(function(data){if(IsJsonString(data)){var obj=jQuery.parseJSON(data);setTimeout(function(){$(".match_area").html(obj.content);fragrance.register_actions();var waypoint=new Waypoint({element:document.getElementById('fragrance_image'),handler:function(direction){if(direction==="up"){$(".finder-bg").removeClass("activated");}else{$(".finder-bg").addClass("activated");}}});},0);}else{console.log(data);}});};})();$(document).ready(function(){"use strict";var easeOutCubic=function(t,b,c,d){var ts=(t/=d)*t;var tc=ts*t;return b+c*(1.77635683940025e-15*tc*ts+0.999999999999998*tc+-3*ts+3*t);};var options={easingFn:easeOutCubic,useEasing:true,useGrouping:true,separator:',',decimal:'.',prefix:'',suffix:''};var count_target=$("#count_target").val();var count=new CountUp("count_up_target",0,count_target,0,5,options);count.start();fragrance=new SSFragranceFinder();on_final_page=($("#ssff_final_page").val()==="yes")?"true":"false";fragrance.load();fragrance.load_matches();});